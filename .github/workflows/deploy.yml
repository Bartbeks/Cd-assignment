name: Deploy

on:
  push:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v1

      # - name: test2 ssh connection
      #   uses: appleboy/ssh-action@master
      #   with:
      #     HOST: ${{ secrets.HOST }}
      #     PORT: ${{ secrets.PORT }}
      #     USERNAME: ${{ secrets.USERNAME }}
      #     KEY: ${{ secrets.SSHKEY }}
      # source: "."
      # target: "/var/www/t-tauri/"
      - name: test2 ssh connection
        uses: appleboy/scp-action@master
        with:
          HOST: ${{ secrets.HOST }}
          PORT: ${{ secrets.PORT }}
          USERNAME: ${{ secrets.USERNAME }}
          KEY: ${{ secrets.SSHKEY }}
          source: "."
          target: "/home/test2/"
          #  - name: copy contents to VPS via ssh key
          #   uses: appleboy/scp-action@master
          #   env:
          #     HOST: ${{ secrets.HOST }}
          #     USERNAME: ${{ secrets.USERNAME }}
          #     KEY: ${{ secrets.SSHKEY }}
          #     PORT: ${{ secrets.PORT }}
          #   with:
          #     source: "."
          #     target: "/home/"
      - name: executing remote ssh commands
        uses: appleboy/ssh-action@master
        with:
          HOST: ${{ secrets.HOST }}
          USERNAME: ${{ secrets.USERNAME }}
          KEY: ${{ secrets.SSHKEY }}
          PORT: ${{ secrets.PORT }}
          script: sh /home/test2/command.sh
          # script: |
          #   cd /home
          #   echo 'Entering test5'
          #   mkdir test2
          #   echo 'test 2'
          #   cd test2
          #   touch test2.txt
          #   # git pull
          #   # echo 'Repository has been pulled'
          #   # systemctl restart test
          #   # echo 'test restarted'
          # script: |
          #   whoami
